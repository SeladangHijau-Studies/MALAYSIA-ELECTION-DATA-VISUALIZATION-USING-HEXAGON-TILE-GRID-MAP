<!-- todo = buat json file dynamic -->

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
        <title>MALAYSIA ELECTION DATA VISUALIZATION USING HEXAGON TILE-GRID MAP</title>

        <link rel="stylesheet" href="../lib/css/bootstrap.min.css" />
        <link rel="stylesheet" href="../lib/css/bootstrap-theme.min.css" />
        <style>
            * {
                margin: 0 auto;
            }

            svg {
                overflow: hidden;
                border: 1px solid black;
                background-color: rgba(0, 0, 0, .05);
            }

            ul {
                list-style: none;
            }

            img[class="tick"] {
                visibility: hidden;
            }

            .tooltip {
                line-height: 1;
                font-weight: bold;
                padding: 12px;
                background: rgba(0, 0, 0, 0.8);
                border-radius: 5px;
                visibility: hidden;
                position: absolute;
                z-index: 10;
                font-weight: bold;
                color: white;
            }

            .popup {
                border-radius: 10px;
                color: white;
                background-color: rgba(0, 0, 0, .8);
            }

            .state-label {
                font-weight: bold;
                color: white;
            }

            #chart-election svg,
            #chart-demography svg {
                border: none;
                background-color: none;
            }
        </style>
    </head>

    <body>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-offset-3 col-md-6">
                    <h3><b>MALAYSIA ELECTION DATA VISUALIZATION (GE-14)</b></h3>
                    <ul><li><h4>USING HEXAGON TILE GRID MAP</h4></li></ul>
                </div>
            </div>
            <div class="row">
                <!-- popup -->
                <div class="col-md-5 popup" style="margin-left: 30px;">
                    <div class="popup-content"></div>
                </div>

                <!-- map -->
                <div class="col-md-5">
                    <div id="chart-map"></div>
                </div>
            </div>
        </div>

        <script src="../lib/js/jquery-3.3.1.min.js"></script>
        <script src="../lib/js/d3.min.js"></script>
        <script src="../lib/js/d3-hexbin.min.js"></script>
        <script src="../lib/js/bootstrap.min.js"></script>
        <script>
            d3.json("../json/setting.json", function(setting) {
                // initialize settings
                var level = 1
                    // attr for zooming
                    scale = 1.0,
                    zoomScale = 3.5;
                var zoom = d3.behavior.zoom()
                    .scale(scale)
                    .scaleExtent([1, 5])
                    .on("zoom", zoomed);
                var svg = d3.select("#chart-map").append("svg")
                    .attr("width", setting.width)
                    .attr("height", setting.height)
                    .call(zoom)
                    .append("g")
                        .attr("id", "zoomContainer")
                        .append("g");
                var hexbin = d3.hexbin()
                    .radius(setting.hexagon_radius);
                var tooltip = d3.select("body")
                    .append("div")
                        .attr("class", "tooltip");
                var selectedState = null;
                var zoomContainer = d3.select("#zoomContainer");
                var defaultView = "";
                var vx = null, // container x coordinate
                    vy = null, // container y coordinate
                    vw = null, // container width
                    vh = null; // container height

                function resetView() {
                    var bbox = zoomContainer.node().getBBox();

                    scale = 1.0;
                    vx = bbox.x; // container x coordinate
                    vy = bbox.y; // container y coordinate
                    vw = bbox.width; // container width
                    vh = bbox.height; // container height
                    defaultView = vx + " " + vy + " " + vw + " " + vh;
                    zoomContainer.attr("transform", "translate(0,0)scale(1,1)");
                    zoom.scale(scale)
                        .translate([0,0]);
                }
                function zoomed() {
                    var translateX = d3.event.translate[0];
                    var translateY = d3.event.translate[1];
                    var xScale = d3.event.scale;

                    zoomContainer.attr("transform", "translate(" + translateX + "," + translateY + ")scale(" + xScale + ")");
                }
                function getTransform(node, xScale) {
                    var bbox = node.node().getBBox();
                    var bx = bbox.x;
                    var by = bbox.y;
                    var bw = bbox.width;
                    var bh = bbox.height;
                    var tx = -bx*xScale + vx + vw/2 - bw*xScale/2;
                    var ty = -by*xScale + vy + vh/2 - bh*xScale/2;
                    return { translate: [tx, ty], scale: xScale }
                }
                function zoomIn() {
                    var transform = getTransform(selectedState, zoomScale);

                    zoomContainer.transition().duration(1000)
                        .attr("transform", "translate(" + transform.translate + ")scale(" + transform.scale + ")");
                    zoom.scale(transform.scale)
                        .translate(transform.translate);
                    scale = transform.scale;
                }
                function loadHorizontalBarChart(id, barChartDiv, data, w, h) {
                    var chartSetting = {
                        width: w,
                        height: h,
                        padding: 10,
                        labelPad: 60
                    };

                    var barSVG = null;
                    if(document.getElementById(id) == null)
                        barSVG = barChartDiv.append("svg")
                            .attr("id", id)
                            .attr("width", chartSetting.width)
                            .attr("height", chartSetting.height);
                    else
                        barSVG = barChartDiv.select("#" + id)
                            .attr("width", chartSetting.width)
                            .attr("height", chartSetting.height);
                                
                    var xScale = d3.scale.linear()
                        .domain([0, d3.max(data, function(d) { return d.value; })])
                        .range([0, chartSetting.width - chartSetting.padding - chartSetting.labelPad - chartSetting.padding]);
                    var yScale = d3.scale.ordinal()
                        .domain(data.map(function (d) { return d.value; }))
                        .rangeRoundBands([0, chartSetting.height - chartSetting.padding], .1);

                    // draw bar
                    barSVG.selectAll('.bar')
                        .data(data)
                        .enter().append('rect')
                            .attr('class', 'bar')
                            .attr('x', chartSetting.padding + chartSetting.labelPad)
                            .attr('y', function(d) { return yScale(d.value); })
                            .attr('width', 0)
                            .attr('height', yScale.rangeBand())
                            .attr('fill', function(d) { return d.color; })
                            .transition().duration(500)
                                .delay(function(d, i) { return i * 100; })
                                .attr("width", function (d, i) { return xScale(d.value); });
                                
                    // race label
                    barSVG.selectAll(".label .label-race")
                        .data(data)
                        .enter().append("text")
                            .attr('class', 'label label-race')
                            .text(function(d) { return d.label; })
                            .attr('x', chartSetting.padding)
                            .attr('y', function(d) { return yScale(d.value) + yScale.rangeBand(); })
                            .style("fill", "white")
                            .style("text-shadow", "-1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black") // initialize lable outline
                            .style("opacity", 0)
                            .transition().duration(500)
                                .delay(function(d, i) { return i * 100; })
                                .attr('x', chartSetting.padding + chartSetting.labelPad + 10)
                                .style("opacity", 1);

                    // value label
                    barSVG.selectAll(".label .label-value")
                        .data(data)
                        .enter().append("text")
                            .attr('class', 'label label-value')
                            .text(function(d) { return d.value +"%"; })
                            .attr('x', chartSetting.padding)
                            .attr('y', function(d) { return yScale(d.value) + yScale.rangeBand(); })
                            .style("fill", "white")
                            .style("text-shadow", "-1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black") // initialize lable outline
                            .style("opacity", 0)
                            .transition().duration(500)
                                .delay(function(d, i) { return i * 100; })
                                .attr('x', chartSetting.padding)
                                .style("opacity", 1);
                }
                function loadPieChart(id, pieChartDiv, data, w, h, outR, inR) {
                    var pieSVG = null;
                    if(document.getElementById(id) == null)
                        pieSVG = pieChartDiv.append("svg")
                            .attr("id", id)
                            .attr("width", w)
                            .attr("height", h)
                            .data(data)
                            .append("g")
                                .attr("transform", "translate(" + (w/2) + "," + (h/2) + ")");
                    else
                        pieSVG = pieChartDiv.select("#" + id)
                            .attr("width", w)
                            .attr("height", h)
                            .data(data)
                            .append("g")
                                .attr("transform", "translate(" + (w/2) + "," + (h/2) + ")");

                    var arc = d3.svg.arc()
                        .innerRadius(inR)
                        .outerRadius(outR);
                    var pie = d3.layout.pie()
                        .value(function(d) { return d.value; });
                    var arcs = pieSVG.selectAll(".slice")
                        .data(pie(data))
                        .enter().append("g")
                            .attr("class", "slice");

                    arcs.append("path")
                        .attr("fill", function(d, i) { return data[i].color; })
                        .attr("d", arc);

                    arcs.append("text")
                        .text(function(d, i) {
                            if(data[i].value > 0)
                                return data[i].label;
                        })
                        .attr("transform", function(d, i) {
                            d.innerRadius = inR;
                            d.outerRadius = outR;

                            return "translate(" + arc.centroid(d) + ")";
                        })
                        .attr("text-anchor", "middle")
                        .style("font-weight", "bold")
                        .style("fill", "white")
                        .style("text-shadow", "-1px -1px 0 black, 1px -1px 0 black, -1px 1px 0 black, 1px 1px 0 black"); // initialize lable outline
                }

                d3.json("../json/parliament.json", function(parliamentList) {
                    // init coordinate data from json
                    var parliamentCoordinateList = [];
                    for(var x=0 ; x<parliamentList.length ; x++) {
                        var tempCoordinate = [];
                        for(var y=0 ; y<parliamentList[x].parliament.length ; y++) {
                            var xyCoor = [];

                            xyCoor.push(parliamentList[x].parliament[y].coordinate.x);
                            xyCoor.push(parliamentList[x].parliament[y].coordinate.y);
                            tempCoordinate.push(xyCoor);
                        }

                        parliamentCoordinateList.push(tempCoordinate);
                    }

                    close_popup = function() {
                        level = 1;

                        resetView();
                        
                        d3.selectAll(".tick").style("visibility", "hidden");
                        d3.select("#btn-popup-close").style("visibility", "hidden");
                        d3.selectAll("g")
                            .style("opacity", 1);
                        d3.select(".system-title")
                            .style("visibility", "visible");
                        d3.selectAll(".state-label")
                            .style("visibility", "visible");
                        selectedState.selectAll(".parliament")
                            .attr("class", "parliament");
                        
                        $(".popup-content").load("popup-index.html"); // load index popup

                        for(var x=0 ; x<setting.state_id.length ; x++)
                            if(setting.state_id[x] == selectedState.attr("id"))
                                selectedState.selectAll(".parliament")
                                    .style("stroke", function() {
                                        return setting.colors.states[x];
                                    })
                                    .style("fill", function() {
                                        return setting.colors.states[x];
                                    });
                    }

                    d3.json("../json/election.json", function(election) {
                        var g = svg.selectAll("g")
                            .data(parliamentList);

                        // populate data visualization                        
                        g.enter().append("g")
                            .attr("id", function(d, i) {
                                return setting.state_id[i];
                            })
                            .attr("class", "state")
                            .style('fill', function(d, i) {
                                return setting.colors.states[i];
                            })
                            .style('stroke', function(d, i) {
                                return setting.colors.states[i];
                            })
                            .on("click", function(d, i, j) { // show state demography
                                if(level == 1) {
                                    level = 2;
                                    selectedState = d3.select(this);
                                        
                                    $(document).ready(function() {
                                        $(".popup-content").load("popup-state.html", function() {
                                            d3.json("../json/demography.json", function(demography) {
                                                var parliamentResult = election[j].result[i];
                                                var demographicResult = demography[i].demography.state;
                                                var stateName = parliamentList[j].state_name;

                                                d3.select("#state-name")
                                                    .text(stateName)
                                                    .style("fill", "white");
                                                
                                                d3.select("#title-male").style("color", "green");
                                                d3.select("#title-female").style("color", "blue");

                                                d3.select("#gender-male").text(demographicResult.gender.male);
                                                d3.select("#gender-female").text(demographicResult.gender.female);
                                                
                                                // initialize pie chart
                                                var genderData = [
                                                    { "label": "Male", "value": demographicResult.gender.male, "color": "green" },
                                                    { "label": "Female", "value": demographicResult.gender.female, "color": "blue" }
                                                ];
                                                
                                                /*
                                                loadBarChart("state-demography",
                                                    d3.select("#chart-demography"),
                                                    genderData,
                                                    { h: 350, w: 190 },
                                                    { w: 80, hr: 5000 },
                                                    { x: 20, y: 20 });
                                                */
                                                loadPieChart("state-demography",
                                                    d3.select("#chart-demography"),
                                                    genderData,
                                                    250, 250,
                                                    120, 50);

                                            });
                                        });
                                    });
                                    
                                    zoomContainer = svg;
                                    zoomIn();

                                    tooltip.transition().duration(200)		
                                        .style("opacity", 0);
                                    d3.selectAll(".state-label")
                                        .style("visibility", "hidden");
                                    d3.select("#" + selectedState.attr("id") + "-label")
                                        .style("visibility", "visible");
                                    d3.select("#btn-popup-close")
                                        .style("visibility", "visible");
                                    d3.selectAll("g")
                                        .style("opacity", function() {
                                            if(d3.select(this).attr("class") == "state")
                                                return .2;
                                            else
                                                return 1;
                                                
                                        });
                                    d3.select(this)
                                        .style("opacity", 1)
                                        .selectAll(".parliament")
                                        .attr("class", "parliament active")
                                        .style("stroke", "white")
                                        .style("fill", function(d, j) {
                                            var winner = election[i].result[j].winner.party;

                                            switch(winner) {
                                                case "BN":
                                                    return setting.colors.parties.BN;
                                                    break;
                                                case "PH":
                                                    return setting.colors.parties.PH;
                                                    break;
                                                case "PAS":
                                                    return setting.colors.parties.PAS;
                                                    break;
                                                case "OTH":
                                                    return setting.colors.parties.OTH;
                                                    break;
                                            }
                                        });
                                }
                            })
                            .selectAll(".parliament")
                            .data(function(d, i) {
                                return hexbin(parliamentCoordinateList[i]);
                            })
                            .enter().append("path")
                                .attr("class", "parliament")
                                .attr("id", function(d, i, j) {
                                    return parliamentList[j].parliament[i].parliament_code;
                                })
                                .attr("d", function(d) {
                                    return "M" + (d.x + setting.padding)
                                        + ","
                                        + (d.y + setting.padding) + hexbin.hexagon();
                                })
                                .on("mouseover", function(d, i, j) {
                                    var thisHex = d3.select(this).attr("class");

                                    if((level == 2) && (thisHex == "parliament active")) {
                                        tooltip.transition().duration(200)
                                            .text(parliamentList[j].parliament[i].parliament_code
                                                + " : "
                                                + parliamentList[j].parliament[i].parliament_name)
                                            .style("opacity", .9)
                                            .style("visibility", "visible");
                                    }
                                })
                                .on("mousemove", function() {
                                    tooltip.style("top", (event.pageY - 10)+"px")
                                        .style("left",(event.pageX + 20)+"px");
                                })
                                .on("mouseout", function() {
                                    tooltip.transition().duration(200)		
                                        .style("opacity", 0);
                                })
                                .on("click", function(d, i, j) { // show parliament demography
                                    var thisHex = d3.select(this).attr("class");

                                    if((level == 2) && (thisHex == "parliament active")) {
                                        d3.json("../json/demography.json", function(demography) {
                                            var stateName = election[j]['state_name'];
                                            var parliamentResult = election[j].result[i];
                                            var demographicResult = demography[j].demography.parliament[i];
                                            var parliamentName = parliamentList[j].parliament[i].parliament_name;

                                            $(document).ready(function() {
                                                $(".popup-content").load("popup-parliament.html", function() {
                                                    d3.select("#title-malay")
                                                        .style("color", setting.colors.race.malay);
                                                    d3.select("#title-chinese")
                                                        .style("color", setting.colors.race.chinese);
                                                    d3.select("#title-indian")
                                                        .style("color", setting.colors.race.indian);
                                                    d3.select("#title-sabah")
                                                        .style("color", setting.colors.race.sabah);
                                                    d3.select("#title-sarawak")
                                                        .style("color", setting.colors.race.sarawak);
                                                    d3.select("#title-others")
                                                        .style("color", setting.colors.race.others);
                                                        
                                                    d3.select("#parliament-code").text(parliamentResult.parliament_code);
                                                    d3.select("#parliament-name").text(parliamentName);
                                                    d3.select("#vote-BN").text(parliamentResult.vote.BN);
                                                    d3.select("#vote-PH").text(parliamentResult.vote.PH);
                                                    d3.select("#vote-PAS").text(parliamentResult.vote.PAS);
                                                    d3.select("#vote-OTH").text(parliamentResult.vote.OTH);
                                                    d3.select("#candidate-BN").text(parliamentResult.candidate.BN);
                                                    d3.select("#candidate-PH").text(parliamentResult.candidate.PH);
                                                    d3.select("#candidate-PAS").text(parliamentResult.candidate.PAS);
                                                    d3.select("#candidate-OTH").text(parliamentResult.candidate.OTH);
                                                    d3.select("#race-malay").text(demographicResult.race.malay);
                                                    d3.select("#race-chinese").text(demographicResult.race.chinese);
                                                    d3.select("#race-indian").text(demographicResult.race.indian);
                                                    d3.select("#race-sabah").text(demographicResult.race.sabah);
                                                    d3.select("#race-sarawak").text(demographicResult.race.sarawak);
                                                    d3.select("#race-other").text(demographicResult.race.others);
                                                    
                                                    d3.selectAll(".tick").style("visibility", "hidden");
                                                    switch(parliamentResult.winner.party) {
                                                        case "BN":
                                                            d3.select("#winner-BN").style("visibility", "visible");
                                                            break;
                                                        case "PH":
                                                            d3.select("#winner-PH").style("visibility", "visible");
                                                            break;
                                                        case "PAS":
                                                            d3.select("#winner-PAS").style("visibility", "visible");
                                                            break;
                                                        case "OTH":
                                                            d3.select("#winner-OTH").style("visibility", "visible");
                                                            break;
                                                    }

                                                    // load pie chart
                                                    var voteData = [
                                                        { "label": "BN", "value": parliamentResult.vote.BN, "color": setting.colors.parties.BN },
                                                        { "label": "PH", "value": parliamentResult.vote.PH, "color": setting.colors.parties.PH },
                                                        { "label": "PAS", "value": parliamentResult.vote.PAS, "color": setting.colors.parties.PAS },
                                                        { "label": "OTH", "value": parliamentResult.vote.OTH, "color": setting.colors.parties.OTH },
                                                    ];
                                                    if(stateName == "SABAH")
                                                        var demographyData = [
                                                            { "label": "Muslim Bumiputera", "value": demographicResult.race.muslim_bumiputera, "color": setting.colors.race.sabah },
                                                            { "label": "Non-Muslim Bumiputera", "value": demographicResult.race.non_muslim_bumiputera, "color": setting.colors.race.sarawak },
                                                            { "label": "Chinese", "value": demographicResult.race.chinese, "color": setting.colors.race.chinese },
                                                            { "label": "Others", "value": demographicResult.race.others, "color": setting.colors.race.others }
                                                        ];
                                                    else
                                                        var demographyData = [
                                                            { "label": "Malay", "value": demographicResult.race.malay, "color": setting.colors.race.malay },
                                                            { "label": "Chinese", "value": demographicResult.race.chinese, "color": setting.colors.race.chinese },
                                                            { "label": "Indian", "value": demographicResult.race.indian, "color": setting.colors.race.indian },
                                                            { "label": "Sarawak", "value": demographicResult.race.sarawak, "color": setting.colors.race.sarawak },
                                                            { "label": "Sabah", "value": demographicResult.race.sabah, "color": setting.colors.race.sabah },
                                                            { "label": "Others", "value": demographicResult.race.others, "color": setting.colors.race.others }
                                                        ];

                                                    loadPieChart(
                                                        "parliament-election",
                                                        d3.select("#chart-election"),
                                                        voteData,
                                                        150, 150,
                                                        70, 30);
                                                    loadHorizontalBarChart(
                                                        "parliament-demography",
                                                        d3.select("#chart-demography"),
                                                        demographyData,
                                                        500, 150);
                                                });
                                            });

                                            d3.select("#btn-popup-close").style("visibility", "visible");
                                        });
                                    }
                                });

                            // initialize popup board for index
                            $(".popup-content").load("popup-index.html");
                            
                            // initialize zoom container
                            zoomContainer.select("g")
                                .attr("transform", "translate(0,0)scale(1,1)")
                                .style("opacity", 1);

                            // initialize label
                            g.enter().append("text")
                                .text(function(d) { return d.state_name; })
                                .attr("class", "state-label")
                                .attr("id", function(d, i) { return setting.state_id[i] + "-label"; })
                                .style("font-weight", "bold")
                                .style("fill", "black")
                                .style("cursor", "default")
                                .style("pointer-events", "none")
                                .style("text-shadow", function(d, i) { // initialize lable outline
                                    return "-1px -1px 0 "
                                        + setting.colors.states[i] + ", 1px -1px 0 "
                                        + setting.colors.states[i] + ", -1px 1px 0 "
                                        + setting.colors.states[i] + ", 1px 1px 0 "
                                        + setting.colors.states[i];
                                })
                                .attr("x", function(d, i) {
                                    var bbox = d3.select("#" + setting.state_id[i]).node().getBBox();

                                    switch(setting.state_id[i]) {
                                        case "perlis":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 25);
                                            break;
                                        case "kedah":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 20);
                                            break;
                                        case "pulau-pinang":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 55);
                                            break;
                                        case "perak":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 30);
                                            break;
                                        case "kelantan":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 35);
                                            break;
                                        case "terengganu":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 50);
                                            break;
                                        case "kuala-lumpur":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 80);
                                            break;
                                        case "selangor":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 70);
                                            break;
                                        case "putrajaya":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 70);
                                            break;
                                        case "pahang":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 20);
                                            break;
                                        case "negeri-sembilan":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 100);
                                            break;
                                        case "melaka":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 30);
                                            break;
                                        case "johor":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 20);
                                            break;
                                        case "labuan":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 50);
                                            break;
                                        case "sabah":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 30);
                                            break;
                                        case "sarawak":
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2 - 5);
                                            break;
                                        default:
                                            return ((bbox.x + (bbox.x + bbox.width)) / 2);
                                            break;
                                    }
                                })
                                .attr("y",  function(d, i) {
                                    var bbox = d3.select("#" + setting.state_id[i]).node().getBBox();
                                    
                                    switch(setting.state_id[i]) {
                                        case "perlis":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "pulau-pinang":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "perak":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 15);
                                            break;
                                        case "kuala-lumpur":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 10);
                                            break;
                                        case "selangor":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 - 30);
                                            break;
                                        case "putrajaya":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "pahang":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "negeri-sembilan":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "melaka":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "labuan":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        case "sabah":
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2 + 5);
                                            break;
                                        default:
                                            return ((bbox.y + (bbox.y + bbox.height)) / 2);
                                            break;
                                    }
                                });
                    });
                });
            });
        </script>
    </body>
</html>
