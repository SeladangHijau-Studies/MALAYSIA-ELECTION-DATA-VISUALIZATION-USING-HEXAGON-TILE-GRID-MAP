<!DOCTYPE html>
<html>
    <head>
        <title>Pie Chart - Demografi</title>

        <link href="lib/css/bootstrap.min.css" rel="stylesheet" />
        <link href="lib/css/bootstrap-theme.min.css" rel="stylesheet" />
    </head>

    <body>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-offset-4 col-md-4">
                    <div id="chart"></div>
                </div>
            </div>
        </div>

        <script src="lib/js/jquery-3.3.1.min.js"></script>
        <script src="lib/js/bootstrap.min.js"></script>
        <script src="lib/js/d3.min.js"></script>
        <script src="lib/js/d3-hexbin.min.js"></script>
        <script>
            var w = 200,
                h = 200,
                r = 50,
                color = d3.scale.category20c();
            var arc = d3.svg.arc()
                .outerRadius(r);
            var pie = d3.layout.pie()
                .value(function(d) { return d.value; });

            d3.json("json/demography.json", function(demography) {
                var ethnicDemography;

                for(var x=0 ; x<demography.length ; x++) {
                    if(demography[x].state_name == "KEDAH") {
                        ethnicDemography = [
                            {"label": "Malay", "value": demography[x].demography.ethnic.malay},
                            {"label": "Indian", "value": demography[x].demography.ethnic.indian},
                            {"label": "Chinese", "value": demography[x].demography.ethnic.chinese},
                            {"label": "Others", "value": demography[x].demography.ethnic.others}
                        ];

                        break;
                    }
                }
                
                var ethnicSVG = d3.select("#chart").append("svg")
                    .attr("width", w)
                    .attr("height", h)
                    .style("background-color", "black")
                    .data([ethnicDemography])
                    .append("g")
                        .attr("transform", "translate(" + (w/2) + "," + (h/2) + ")");
                var arcs = ethnicSVG.selectAll(".slice")
                    .data(pie)
                    .enter().append("g")
                        .attr("class", "slice");
                
                arcs.append("path")
                    .attr("fill", function(d, i) { return color(i); })
                    .attr("d", arc);

                arcs.append("text")
                    .attr("transform", function(d, i) {
                        d.innerRadius = 0;
                        d.outerRadius = r;

                        return "translate(" + arc.centroid(d) + ")";
                    })
                    .attr("text-anchor", "middle")
                    .text(function(d, i) { return ethnicDemography[i].label; });
            });
        </script>
    </body>
</html>